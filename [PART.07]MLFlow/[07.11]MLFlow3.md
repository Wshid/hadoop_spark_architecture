## 7.11. MLFlow 3

### MLFlow Model
- `MLFlow model`은 다양한 **배포 환경**을 지원하는 범용 모델 형식
- `MLFlow Proejct`와 `Model`은 매우 유사
- `MLFlow Model`은 다른 도구를 사용하여 작성 가능
  - 그러나 `training`환경과 별도 배포도 가능
- 이런 환경은 `Docker/k8s`를 포함한 **container** 또는
  - `AWS SageMaker/Azure ML`과 같은 **클라우드 환경**에서 같음
- **스트리밍/일괄 채점 도구** -> spark
- e.g. k8s를 사용하여 `Tensorflow model` 생성
  - `R&D` 팀은 **스트림/배치 점수 매기기**기능이 있는 `Spark ML Model`을 생성
  - 하지만 회사는 `R&D Model` 내 `Tensorflow model` 동일한 환경에서 함께 생산하기를 원함
  - 장기적으로 `model/artifect`를 쉽게 유지/관리하기 위해
    - 여러 환경에서 이를 실행하기를 원함
- 여러 프레임워크를 **여러 배포 대상**에 매핑하는 솔루션은
  - `MLFlow Model`이라는 **범용 모델 추상화**
- 일반적인 `ML 도구`를 사용하여 간단히 모델 생성 후
  - 다양한 배포환경에 배포 가능
- 이 중간계층을 활용하면 **매핑 문제 해결** 가능
- `MLFlow Model`은 `Directory` 구조와 같이 `MLFlow Project`와 유사
- `MLFlow Project`와 같이 `training code`를 포함하는 반면
  - **구성 파일**이 포함되어 있으며 **모델 아티팩트**가 포함됨
  - **종속성 집합**이 포함된 `condda/docker` 환경
- `MLFlow`는 다양한 **프레임워크 모델**을 `MLFlow` 형식으로 **직렬화**하기 위한 **모델 생성 도구**를 제공
- MLFlow에는 `MLFlow Model`을 `RESTful Service`로 생산하기 위한 **배포 API**가 존재
  - 이 API는 `Python, Java, R, CLI`로 사용 가능
- `Keras Flavor` model 형식 생성 가능
  - 그 이후 `API 함수`를 사용하여
  - 해당 model flavor를 `python code bit`로 변환
  - 이후 `modelpredict`를 호출하여 예측
- 이 예시에는 `model`과 함께 bundle로 제공되는 **두가지 flavor**가 존재
  - `keras flavor`
    - `MLFlow model`이 기본 `keras` 객체로 로드
    - 평가/추가 traning을 위해 모든 `Keras API`와 함께 사용 가능
  - `python function flavor`
    - 모델 로드 및 평가를 위한 **추가 추상화 계층**을 도입
    - `python function`을 사용하여 `MLFlow Model`은
      - `Pandas Dataframe`을 수락하는 간단한 `python` 함수로 나타낼 수 있음
    - 이 모델을 평가하기 위해 더 이상 `keras library`에 대해 걱정할 필요 x